SELECT
  `b`.`SEQ_NUM` AS `SEQ_NUM`,
  `b`.`USER_SEQ_NUM` AS `USER_SEQ_NUM`,
  concat(
    `c`.`FIRST_NAME`,
    ' ',
    `c`.`LAST_NAME`,
    '/',
    `c`.`EMAIL`
  ) AS `FULL_NAME`,
  `b`.`INFO_SEQ_NUM` AS `INFO_SEQ_NUM`,
  `b`.`INFO_D_SEQ_NUM` AS `INFO_D_SEQ_NUM`,
  `b`.`SERVICE_NO` AS `SERVICE_NO`,
  `s`.`SEQ_NUM` AS `SERVICE_SEQ_NUM`,
  `p`.`NAME` AS `PACKAGE_NAME`,
  `s`.`SERVICE` AS `SERVICE_NAME`,
  `b`.`SERVICE_FEE` AS `SERVICE_FEE`,
  coalesce(`a`.`ID_SEQ`, `i`.`ID_SEQ`) AS `ID_SEQ`,
  coalesce(`a`.`IMEI`, `i`.`IMEI`) AS `IMEI`,
  `a`.`IPHONE_CARRIER` AS `IPHONE_CARRIER`,
  `i`.`IPHONE_CARRIER_FMI_BLACKLIST` AS `IPHONE_CARRIER_FMI_BLACKLIST`,
  `i`.`ICLOUD_ON_OFF` AS `ICLOUD_ON_OFF`,
  `i`.`APPLE_MDM_STATUS` AS `APPLE_MDM_STATUS`,
  `a`.`IPHONE_SIM_LOCK` AS `IPHONE_SIM_LOCK`,
  `i`.`APPLE_BASIC_INFO` AS `APPLE_BASIC_INFO`,
  coalesce(`a`.`ENTRY_DATE`, `i`.`ENTRY_DATE`) AS `ENTRY_DATE`,
  `b`.`SEARCH_DATE` AS `SEARCH_DATE`,
  sum(`b`.`SERVICE_FEE`) OVER (PARTITION BY `b`.`USER_SEQ_NUM`) AS `TOTAL_COST`,
  `a`.`APPLE_ACTIVATION_STATUS_IMEI_SN` AS `APPLE_ACTIVATION_STATUS_IMEI_SN`,
  `a`.`MDM_LOCK_BYPASS_IPHONE_IPAD` AS `MDM_LOCK_BYPASS_IPHONE_IPAD`,
  `i`.`WW_BLACKLIST_STATUS` AS `WW_BLACKLIST_STATUS`,
  `i`.`USA_T_MOBILE_CLEAN` AS `USA_T_MOBILE_CLEAN`,
  `i`.`USA_AT_T_CLEAN_ACTIVE_LINE` AS `USA_AT_T_CLEAN_ACTIVE_LINE`,
  `i`.`USA_CRICKET_CLEAN_6_MONTHS_OLD` AS `USA_CRICKET_CLEAN_6_MONTHS_OLD`,
  `i`.`CLARO_ALL_COUNTRIES_PREMIUM_IPHONE_14` AS `CLARO_ALL_COUNTRIES_PREMIUM_IPHONE_14`,
  `i`.`CLARO_ALL_COUNTRIES_PREMIUM_IPHONE_15` AS `CLARO_ALL_COUNTRIES_PREMIUM_IPHONE_15`,
  `i`.`CLARO_ALL_COUNTRIES_PREMIUM_UP_TO_IPHONE_13` AS `CLARO_ALL_COUNTRIES_PREMIUM_UP_TO_IPHONE_13`,
  `i`.`SAMSUNG_AT_T_CRICKET_ALL_MODELS` AS `SAMSUNG_AT_T_CRICKET_ALL_MODELS`,
  `a`.`ONEPLUS_INFO` AS `ONEPLUS_INFO`,
  `a`.`MOTOROLA_INFO` AS `MOTOROLA_INFO`,
  `a`.`GOOGLE_PIXEL_INFO` AS `GOOGLE_PIXEL_INFO`,
  `a`.`SAMSUNG_INFO` AS `SAMSUNG_INFO`,
  `a`.`SAMSUNG_INFO_PRO` AS `SAMSUNG_INFO_PRO`,
  `a`.`BRAND_MODEL_INFO` AS `BRAND_MODEL_INFO`,
  `s`.`NAME` AS `USER_SERVICE_NAME`,
  `a`.`APPLE_SOLD_BY_COVERAGE` AS `APPLE_SOLD_BY_COVERAGE`,
  `i`.`APPLE_GSX_CASES_REPAIRS` AS `APPLE_GSX_CASES_REPAIRS`,
  `i`.`APPLE_GSX_CASES_ID_INFO` AS `APPLE_GSX_CASES_ID_INFO`,
  `a`.`APPLE_IOS_VERSION_NEXT_TETHER` AS `APPLE_IOS_VERSION_NEXT_TETHER`,
  `i`.`APPLE_GSX_POLICY_WiFi_MAC` AS `APPLE_GSX_POLICY_WiFi_MAC`,
  `i`.`APPLE_FULL_GSX_PREMIUM_INFO` AS `APPLE_FULL_GSX_PREMIUM_INFO`,
  `a`.`APPLE_PART_NUMBER_MPN` AS `APPLE_PART_NUMBER_MPN`,
  `i`.`IPHONE_CARRIER_FMI` AS `IPHONE_CARRIER_FMI`,
  `a`.`IMEI_SN_CONVERT` AS `IMEI_SN_CONVERT`,
  `a`.`APPLE_SERIAL_INFO` AS `APPLE_SERIAL_INFO`,
  `i`.`ICLOUD_CLEAN_LOST` AS `ICLOUD_CLEAN_LOST`,
  `i`.`APPLE_MDM_ICLOUD_GSX_STATUS` AS `APPLE_MDM_ICLOUD_GSX_STATUS`,
  `i`.`MACBOOK_IMAC_ICLOUD_ON_OFF_STATUS` AS `MACBOOK_IMAC_ICLOUD_ON_OFF_STATUS`,
  `i`.`MACBOOK_IMAC_ICLOUD_CLEAN_LOST_STATUS` AS `MACBOOK_IMAC_ICLOUD_CLEAN_LOST_STATUS`,
  `i`.`XIAOMI_MI_ACCOUNT_REMOVE_EUROPE` AS `XIAOMI_MI_ACCOUNT_REMOVE_EUROPE`,
  `i`.`USA_AT_T_UNLOCK_STATUS` AS `USA_AT_T_UNLOCK_STATUS`,
  `i`.`WW_BLACKLIST_STATUS_PRO` AS `WW_BLACKLIST_STATUS_PRO`,
  `i`.`XFINITY_USA_STATUS_PRO` AS `XFINITY_USA_STATUS_PRO`,
  `a`.`TRACFONE_USA_STATUS_PRO` AS `TRACFONE_USA_STATUS_PRO`,
  `i`.`CSPIRE_USA_STATUS_PRO` AS `CSPIRE_USA_STATUS_PRO`,
  `i`.`MYMOBILE_USA_STATUS_PRO` AS `MYMOBILE_USA_STATUS_PRO`,
  `i`.`CRICKET_USA_STATUS_PRO` AS `CRICKET_USA_STATUS_PRO`,
  `i`.`T_MOBILE_USA_STATUS_PRO` AS `T_MOBILE_USA_STATUS_PRO`,
  `i`.`T_MOBILE_USA_SIMLOCK_STATUS` AS `T_MOBILE_USA_SIMLOCK_STATUS`,
  `i`.`VERIZON_USA_STATUS_PRO` AS `VERIZON_USA_STATUS_PRO`,
  `i`.`KOREA_BLACKLIST_STATUS` AS `KOREA_BLACKLIST_STATUS`,
  `i`.`JAPAN_BLACKLIST_STATUS` AS `JAPAN_BLACKLIST_STATUS`,
  `i`.`AUSTRALIA_BLACKLIST_STATUS` AS `AUSTRALIA_BLACKLIST_STATUS`,
  `a`.`LG_INFO` AS `LG_INFO`,
  `a`.`ZTE_INFO` AS `ZTE_INFO`,
  `a`.`ASUS_INFO` AS `ASUS_INFO`,
  `a`.`OPPO_INFO` AS `OPPO_INFO`,
  `a`.`ACER_INFO` AS `ACER_INFO`,
  `a`.`HONOR_INFO` AS `HONOR_INFO`,
  `a`.`DOOGEE_INFO` AS `DOOGEE_INFO`,
  `a`.`REALME_INFO` AS `REALME_INFO`,
  `a`.`HUAWEI_INFO` AS `HUAWEI_INFO`,
  `a`.`LENOVO_INFO` AS `LENOVO_INFO`,
  `a`.`KYOCERA_INFO` AS `KYOCERA_INFO`,
  `a`.`ALCATEL_INFO` AS `ALCATEL_INFO`,
  `a`.`VIVO_IQOO_INFO` AS `VIVO_IQOO_INFO`,
  `a`.`NOTHING_PHONE_INFO` AS `NOTHING_PHONE_INFO`,
  `a`.`SIM_ICCID_IMSI_INFO` AS `SIM_ICCID_IMSI_INFO`,
  `i`.`XIAOMI_MI_LOCK_INFO` AS `XIAOMI_MI_LOCK_INFO`,
  `i`.`XIAOMI_MI_LOCK_STATUS` AS `XIAOMI_MI_LOCK_STATUS`,
  `i`.`SAMSUNG_KNOX_GUARD_INFO` AS `SAMSUNG_KNOX_GUARD_INFO`,
  `a`.`ITEL_TECNO_SONIM_INFO` AS `ITEL_TECNO_SONIM_INFO`,
  `i`.`UK_O2_TESCO_CLEAN` AS `UK_O2_TESCO_CLEAN`,
  `i`.`UK_VODAFONE_CLEAN` AS `UK_VODAFONE_CLEAN`,
  `i`.`CANADA_TELUS_CLEAN` AS `CANADA_TELUS_CLEAN`,
  `i`.`JAPAN_AU_KDDI_CLEAN` AS `JAPAN_AU_KDDI_CLEAN`,
  `i`.`JAPAN_SOFTBANK_CLEAN` AS `JAPAN_SOFTBANK_CLEAN`,
  `i`.`EMEA_SERVICE_PREMIUM` AS `EMEA_SERVICE_PREMIUM`,
  `i`.`JAPAN_NTT_DOCOMO_CLEAN` AS `JAPAN_NTT_DOCOMO_CLEAN`,
  `i`.`US_RESELLER_FLEX_CLEAN` AS `US_RESELLER_FLEX_CLEAN`,
  `i`.`ROMANIA_ORANGE_PREMIUM` AS `ROMANIA_ORANGE_PREMIUM`,
  `i`.`PHILIPPINES_GLOBE_CLEAN` AS `PHILIPPINES_GLOBE_CLEAN`,
  `i`.`CANADA_FIDO_ROGERS_CLEAN` AS `CANADA_FIDO_ROGERS_CLEAN`,
  `i`.`ROMANIA_VODAFONE_PREMIUM` AS `ROMANIA_VODAFONE_PREMIUM`,
  `i`.`USA_AT_T_SOLD_DATE_60_DAYS` AS `USA_AT_T_SOLD_DATE_60_DAYS`,
  `i`.`UK_EE_T_MOBILE_ORANGE_PREMIUM` AS `UK_EE_T_MOBILE_ORANGE_PREMIUM`,
  `i`.`HUNGARY_VODAFONE_PREMIUM_IPHONE_12_TO_14` AS `HUNGARY_VODAFONE_PREMIUM_IPHONE_12_TO_14`,
  `i`.`HUNGARY_VODAFONE_PREMIUM_IPHONE_4S_TO_11` AS `HUNGARY_VODAFONE_PREMIUM_IPHONE_4S_TO_11`,
  `i`.`UK_O2_CLEAN` AS `UK_O2_CLEAN`,
  `i`.`FRANCE_BOUYGUES` AS `FRANCE_BOUYGUES`,
  `i`.`LG_2019_DATABASE` AS `LG_2019_DATABASE`,
  `i`.`CANADA_VIDEOTRON` AS `CANADA_VIDEOTRON`,
  `i`.`LG_2020_DATABASE` AS `LG_2020_DATABASE`,
  `i`.`HTC_INTERNATIONAL` AS `HTC_INTERNATIONAL`,
  `i`.`CANADA_BELL_NCK_CODE` AS `CANADA_BELL_NCK_CODE`,
  `i`.`SAMSUNG_EUROPE_PREMIUM` AS `SAMSUNG_EUROPE_PREMIUM`,
  `i`.`SAMSUNG_UK_IRELAND_PREMIUM` AS `SAMSUNG_UK_IRELAND_PREMIUM`,
  `i`.`SAMSUNG_EUROPE_LIMITED_COUNTRIES` AS `SAMSUNG_EUROPE_LIMITED_COUNTRIES`
FROM
  (
    (
      (
        (
          (
            (
              `imei_info`.`imei_user_junction` `b`
              LEFT JOIN `imei_info`.`info` `a` ON((`a`.`ID_SEQ` = `b`.`INFO_SEQ_NUM`))
            )
            LEFT JOIN `imei_info`.`user_info` `c` ON((`c`.`SEQ_NUM` = `b`.`USER_SEQ_NUM`))
          )
          LEFT JOIN `imei_info`.`package_service_junction` `d` ON((`d`.`SEQ_NUM` = `b`.`SERVICE_NO`))
        )
        LEFT JOIN `imei_info`.`packages` `p` ON((`d`.`PACKAGE_SEQ_NUM` = `p`.`SEQ_NUM`))
      )
      LEFT JOIN `imei_info`.`services` `s` ON((`d`.`SERVICE_SEQ_NUM` = `s`.`SEQ_NUM`))
    )
    LEFT JOIN `imei_info`.`info_delay` `i` ON((`i`.`ID_SEQ` = `b`.`INFO_D_SEQ_NUM`))
  )
ORDER BY
  `b`.`SEQ_NUM` DESC,
  `b`.`SERVICE_FEE`